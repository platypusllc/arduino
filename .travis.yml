# Tests building of example application in Arduino.
language: cpp
env:
 # Test against the Arduino DUE.
 - BOARD=arduino:sam:due NAME=ExampleFirmware

compiler:
 - gcc

before_install:
 - sudo apt-get update -qq && sudo apt-get install -qq openjdk-6-jre avr-libc gcc-avr xvfb

install:
 # Arduino IDE + build tools
 - wget http://downloads-02.arduino.cc/arduino-1.6.4-linux64.tar.xz
 - tar -xvf arduino-1.6.4-linux64.tar.xz
 - sudo mv arduino-1.6.4/ /usr/local/share/arduino

before_script:
 # arduino requires an X server even with command line
 # https://github.com/arduino/Arduino/issues/1981
 - Xvfb :1 -screen 0 1024x768x16 &> xvfb.log &
 # put your source files in a folder under a new libraries folder
 - sudo mkdir /usr/src/arduino
 - sudo mkdir /usr/src/arduino/libraries
 - sudo ln -s $TRAVIS_BUILD_DIR /usr/src/arduino/libraries/platypus

script:
 - sudo DISPLAY=:1.0 /usr/local/share/arduino/arduino --board $BOARD --pref sketchbook.path=/usr/src/arduino --verify /usr/src/arduino/libraries/platypus/examples/$NAME/$NAME.ino
